<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cykj.net.mapper.SchoolDao">
    <!--    学校信息-->
    <select id="findSchoolinfo" resultType="S1" parameterType="java.lang.String">
         SELECT * FROM schoolinfo WHERE scAccount=#{account}
    </select>
    <select id="findphone" resultType="S1" parameterType="java.lang.String">
         SELECT * FROM schoolinfo WHERE scPhone=#{phone}
    </select>
    <select id="finddaima" resultType="S1" parameterType="java.lang.String">
         SELECT * FROM schoolinfo WHERE xinyongDaima=#{daima}
    </select>
    <!--    插入学校信息-->
    <insert id="inserSchoolinfo" parameterType="S1">
        INSERT INTO schoolinfo (scAccount, password,scdata,scName,scAddress,scfdMan,moneyLaiyuan,kaibanMoney,jubanDanwei,xinyongDaima,scAbout,regTime,scpicture,scState,scPhone,ctid,prid,type) VALUES
        (#{scAccount},#{password},#{scdata},#{scName},#{scAddress},#{scfdMan},#{moneyLaiyuan},#{kaibanMoney},#{jubanDanwei},#{xinyongDaima},#{scAbout},#{regTime},#{scpicture},#{scState},#{scPhone},#{ctid},#{prid},#{type})
    </insert>
    <!--    修改学校信息-->
    <update id="updateSchoolinfo" parameterType="S1">
        UPDATE schoolinfo
        <trim prefix="set" suffixOverrides="," suffix=" where scAccount = #{scAccount} ">
            <if test="password!=null and password.length>0">
                password=#{password},
            </if>
            <if test="scdata!=null and scdata.length>0">
                scdata=#{scdata},
            </if>
            <if test="scName!=null and scName.length>0">
                scName=#{scName},
            </if>
            <if test="scAddress!=null and scAddress.length>0">
                scAddress=#{scAddress},
            </if>
            <if test="scfdMan!=null and scfdMan.length>0">
                scfdMan=#{scfdMan},
            </if>
            <if test="moneyLaiyuan!=null and moneyLaiyuan.length>0">
                moneyLaiyuan=#{moneyLaiyuan},
            </if>
            <if test="kaibanMoney!=null and kaibanMoney.length>0">
                kaibanMoney=#{kaibanMoney},
            </if>
            <if test="jubanDanwei!=null and jubanDanwei.length>0">
                jubanDanwei=#{jubanDanwei},
            </if>
            <if test="xinyongDaima!=null and xinyongDaima.length>0">
                xinyongDaima=#{xinyongDaima},
            </if>
            <if test="scAbout!=null and scAbout.length>0">
                scAbout=#{scAbout},
            </if>
            <if test="scPhone!=null and scPhone.length>0">
                scPhone=#{scPhone},
            </if>
            <if test="scState!=null and scState.length>0">
                scState=#{scState},
            </if>
            <if test="ctid!=null and ctid.length>0">
                ctid=#{ctid},
            </if>
            <if test="prid!=null and prid.length>0">
                prid=#{prid},
            </if>
            <if test="type!=null and type.length>0">
                type=#{type},
            </if>
        </trim>
    </update>
<!--    查看人才信息-->
    <select id="fenyecount1" resultType="int" parameterType="java.util.Map">
        select count(*) from schoolinfo a,userlist b,resume c
        <where>
            a.scAccount=#{account} and a.scAccount=b.tuijianren and b.yhid=c.yhId
            <if test="username != null and username !=''">
                and b.name like '%${username}%'
            </if>
            <if test="lasttime != null and lasttime !=''">
                and b.regTime between #{lasttime} and #{nowtime}
            </if>
            <if test="zy != null and zy !=''">
                and c.zy like '%${zy}%'
            </if>
        </where>
    </select>
    <select id="fenyeshuju1"  resultType="Alluserinfo" parameterType="java.util.Map">
         SELECT * FROM schoolinfo a,userlist b,resume c
        <where>
            a.scAccount=#{account} and a.scAccount=b.tuijianren and b.yhid=c.yhId
            <if test="username != null and username !=''">
                and b.name like '%${username}%'
            </if>
            <if test="lasttime != null and lasttime !=''">
                and b.regTime between #{lasttime} and #{nowtime}
            </if>
            <if test="zy != null and zy !=''">
                and c.zy like '%${zy}%'
            </if>
        </where>
    </select>
<!--    查找简历的教育经历信息-->
    <select id="findexperience" resultType="Experience" parameterType="java.lang.String">
        SELECT a.* FROM experience a,resume b,userlist c where a.jlId=b.jlId and b.yhId=c.yhid and c.account = #{account}
    </select>
<!--    查找简历的工作经历信息-->
    <select id="findegzjl" resultType="Undergo" parameterType="java.lang.String">
        SELECT a.* FROM undergo a,resume b,userlist c where a.jlId=b.jlId and b.yhId=c.yhid and c.account = #{account}
    </select>
<!--    查找省信息-->
    <select id="findpro" resultType="P1">
        select * from province
    </select>
    <!--    查找市信息-->
    <select id="findcity" resultType="C1" parameterType="java.lang.String">
        select b.* from province a,city b where a.prid=b.prid and a.prid=#{prid}
    </select>
<!--    插入用户表-->
    <insert id="inseruserinfo" parameterType="Userlist">
        INSERT INTO userlist (account, password,name,phone,sex,degree,idCard,idCardType,birthday,regTime,picture,state,tuijianren) VALUES
        (#{account},#{password},#{name},#{phone},#{sex},#{degree},#{idCard},#{idCardType},#{birthday},#{regTime},#{picture},#{state},#{tuijianren})
    </insert>
<!--    修改用户表-->
    <update  id="updateuser" parameterType="J1">
        UPDATE userlist
        <trim prefix="set" suffixOverrides="," suffix=" where scAccount = #{scAccount} ">
            <if test="name!=null and name.length>0">
                name=#{name},
            </if>
            <if test="birthday!=null and birthday.length>0">
                birthday=#{birthday},
            </if>
            <if test="name!=null and name.length>0">
                name=#{name},
            </if>
            <if test="sex!=null and sex.length>0">
                sex=#{sex},
            </if>
            <if test="degree!=null and degree.length>0">
                degree=#{degree},
            </if>
            <if test="idCard!=null and idCard.length>0">
                idCard=#{idCard},
            </if>
            <if test="kaibanMoney!=null and kaibanMoney.length>0">
                kaibanMoney=#{kaibanMoney},
            </if>
            <if test="jubanDanwei!=null and jubanDanwei.length>0">
                jubanDanwei=#{jubanDanwei},
            </if>
            <if test="xinyongDaima!=null and xinyongDaima.length>0">
                xinyongDaima=#{xinyongDaima},
            </if>
            <if test="scAbout!=null and scAbout.length>0">
                scAbout=#{scAbout},
            </if>
            <if test="scPhone!=null and scPhone.length>0">
                scPhone=#{scPhone},
            </if>
            <if test="scState!=null and scState.length>0">
                scState=#{scState},
            </if>
            <if test="ctid!=null and ctid.length>0">
                ctid=#{ctid},
            </if>
            <if test="prid!=null and prid.length>0">
                prid=#{prid},
            </if>
            <if test="type!=null and type.length>0">
                type=#{type},
            </if>
        </trim>
    </update>
<!--    插入简历信息-->
    <insert id="inserjl" parameterType="Resume">
        INSERT INTO resume (yhId, zsCertificate,scTime,phone,sex,degree,idCard,idCardType,birthday,regTime,picture,state,tuijianren) VALUES
        (#{account},#{password},#{name},#{phone},#{sex},#{degree},#{idCard},#{idCardType},#{birthday},#{regTime},#{picture},#{state},#{tuijianren})
    </insert>
<!--    查找企业信息 表格-->
    <select id="fenyecount2" resultType="int" parameterType="java.util.Map">
        SELECT count(*) FROM jobinfo a,qyinfo b,station c,position d
        <where>
            a.qyid=b.qyid and a.zwid=c.stid and c.poid=d.poid
            <if test="position != null and position !=''">
                and c.position like '%${position}%'
            </if>
            <if test="type != null and type !=''">
                and d.type like '%${type}%'
            </if>
        </where>
     </select>
    <select id="fenyeshuju2" resultType="com.cykj.net.javabean.J1" parameterType="java.util.Map">
        SELECT * FROM jobinfo a,qyinfo b,station c,position d
        <where>
            a.qyid=b.qyid and a.zwid=c.stid and c.poid=d.poid
            <if test="position != null and position !=''">
                and c.position like '%${position}%'
            </if>
            <if test="type != null and type !=''">
                and d.type like '%${type}%'
            </if>
        </where>
    </select>

</mapper>
