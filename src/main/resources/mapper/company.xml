<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cykj.net.mapper.CompanyDao">
    <!--单条数据插入，返回自增ID序号-->
    <insert id="regQyAccount" parameterType="Qyinfo" keyProperty="qyid" useGeneratedKeys="true">
		insert into
		qyinfo(qyAccount,password,qyData,qyName,regTime) values(#{qyAccount},#{password},#{qyData},#{qyName},#{regTime})
	</insert>
    <!--    查询企业信息表-->
	<select id="findById" parameterType="string" resultType="Qyinfo"
	>
		select * from qyinfo where qyAccount=#{_parameter}
	</select>
    <!--    插入公司信息-->
	<update id="doRegQyinfo" parameterType="Qyinfo" >
		update qyinfo set qyAddress=#{qyAddress},qyfdMan=#{qyfdMan},regMoney=#{regMoney},qyType=#{qyType},jyScope=#{jyScope},jyTime=#{jyTime} where qyAccount=#{qyAccount};
	</update>
    <!--    插入公司简介-->
    <update id="doRegQyKind" parameterType="Qyinfo" >
		update qyinfo set qyKind=#{qyKind} where qyAccount=#{qyAccount};
	</update>
	<!--    修改密码-->
	<update id="changePassword" parameterType="Qyinfo" >
		update qyinfo set password=#{password} where qyAccount=#{qyAccount};
	</update>
	<!--    查询城市信息表-->
	<select id="findProvince"  resultType="com.cykj.net.javabean.Province"
	>
		select * from province
	</select>
	<!--	查询对应省份得城市数据-->
	<select id="chooseCity"  resultType="com.cykj.net.javabean.City"
	>
		select * from city where prid=#{prid};
	</select>
	<!--    查询所有行业-->
	<select id="findPosition"  resultType="com.cykj.net.javabean.Position"
	>
		select * from position
	</select>
	<!--    查询对应岗位-->
	<select id="chooseStation"  resultType="com.cykj.net.javabean.Station"
	>
		select * from station where poid=#{poid};
	</select>
	<!--单条数据插入，返回自增ID序号-->
	<insert id="releaseJobinfo" parameterType="com.cykj.net.javabean.Jobinfo" keyProperty="qyid" useGeneratedKeys="true">
		insert into
		jobinfo(qyid, zwid, lxMan, lxPhone, zpNum, lxAddress, xueliRequire, zhiyeType, gzExperience, majorRequire, gzAddress, salaryLow, welfare, jobDuty, "time", jobinfoState, salaryHigh, ctid, sex, ageLow, ageHigh, beginTime, endTime, dayTime, weekTime, workTime, baoxian, gjijin, jiangjin, zhusu)
		values(
		#{qyid},#{zwid},#{lxMan},#{lxPhone},#{zpNum},#{lxAddress},#{xueliRequire},#{zhiyeType},#{gzExperience},#{majorRequire},#{gzAddress},#{salaryLow},#{welfare},#{jobDuty},#{time},#{jobinfoState},#{salaryHigh},#{ctid},#{sex},#{ageLow},#{ageHigh}, #{beginTime}, #{endTime},#{dayTime} , #{weekTime},#{workTime},#{baoxian}, #{gjijin}, #{jiangjin}, #{zhusu})
	</insert>

	<select id="searchJobinfoTable" resultType="com.cykj.net.javabean.Jobinfo" parameterType="com.cykj.net.javabean.Jobinfo"
	>
	select C.type,B.postion,A.* from
	(select zwid ,concat(beginTime,"至",endTime) zhaopinTime,xueliRequire,concat(ageLow,"-",ageHigh) age,concat(salaryLow,"-",salaryHigh) salary,concat(baoxian,"、",gjijin,"、",jiangjin,"、",zhusu,"、",welfare) xinzifuli,zpNum,jobinfoState,time
	from jobinfo where qyid=#{qyid}) A,station B,position C

		<where>
			<if test="qyid!=null and qyid!=''">
				A.zwid=B.stid and B.poid=C.poid
			</if>
			<if test="jobinfoState!=null and jobinfoState!=''">
				and jobinfoState=#{jobinfoState}
			</if>
			<if test="zwid!=null and zwid!=''">
				and zwid=#{zwid}
			</if>
			<if test="type!=null and type!=''">
				and C.type=#{type}
			</if>
		</where>
	</select>

</mapper>